periodics:
- name: ci-kubernetes-node-release-branch-1-24
  interval: 24h
  labels:
    preset-service-account: "true"
    preset-k8s-ssh: "true"
  spec:
    containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230406-23cb1879e3-master
        args:
          - --repo=k8s.io/kubernetes=release-1.24
          - --timeout=240
          - --root=/go/src
          - --scenario=kubernetes_e2e
          - --
          - --deployment=node
          - --gcp-project-type=node-e2e-project
          - --gcp-zone=us-central1-a
          - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/k8s-release-branches/image-config-1.24.yaml
          - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/usr/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
          - --node-tests=true
          - --provider=gce
          - --test_args=--nodes=8 --focus="\[NodeConformance\]" --skip="\[Flaky\]|\[Slow\]|\[Serial\]"
          - --timeout=180m
        env:
          - name: GOPATH
            value: /go
        resources:
          requests:
            memory: "6Gi"
  annotations:
    testgrid-dashboards: sig-node-release-blocking
    testgrid-tab-name: node-conformance-release-1.24
    testgrid-alert-email: kubernetes-sig-node-test-failures@googlegroups.com
    description: Node conformance tests in release branch 1.24
- name: ci-kubernetes-node-release-branch-1-25
  interval: 24h
  labels:
    preset-service-account: "true"
    preset-k8s-ssh: "true"
  spec:
    containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230406-23cb1879e3-master
        args:
          - --repo=k8s.io/kubernetes=release-1.25
          - --timeout=240
          - --root=/go/src
          - --scenario=kubernetes_e2e
          - --
          - --deployment=node
          - --gcp-project-type=node-e2e-project
          - --gcp-zone=us-central1-a
          - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/k8s-release-branches/image-config-1.25.yaml
          - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/usr/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
          - --node-tests=true
          - --provider=gce
          - --test_args=--nodes=8 --focus="\[NodeConformance\]" --skip="\[Flaky\]|\[Slow\]|\[Serial\]"
          - --timeout=180m
        env:
          - name: GOPATH
            value: /go
        resources:
          requests:
            memory: "6Gi"
  annotations:
    testgrid-dashboards: sig-node-release-blocking
    testgrid-tab-name: node-conformance-release-1.25
    testgrid-alert-email: kubernetes-sig-node-test-failures@googlegroups.com
    description: Node conformance tests in release branch 1.25
- name: ci-kubernetes-node-release-branch-1-26
  interval: 24h
  labels:
    preset-service-account: "true"
    preset-k8s-ssh: "true"
  spec:
    containers:
      - image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230406-23cb1879e3-master
        args:
          - --repo=k8s.io/kubernetes=release-1.26
          - --timeout=240
          - --root=/go/src
          - --scenario=kubernetes_e2e
          - --
          - --deployment=node
          - --gcp-project-type=node-e2e-project
          - --gcp-zone=us-central1-a
          - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/k8s-release-branches/image-config-1.26.yaml
          - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/usr/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
          - --node-tests=true
          - --provider=gce
          - --test_args=--nodes=8 --focus="\[NodeConformance\]" --skip="\[Flaky\]|\[Slow\]|\[Serial\]"
          - --timeout=180m
        env:
          - name: GOPATH
            value: /go
        resources:
          requests:
            memory: "6Gi"
  annotations:
    testgrid-dashboards: sig-node-release-blocking
    testgrid-tab-name: node-conformance-release-1.26
    testgrid-alert-email: kubernetes-sig-node-test-failures@googlegroups.com
    description: Node conformance tests in release branch 1.26
presubmits:
  kubernetes/kubernetes:
  - always_run: false
    branches:
    - release-1.25
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-25
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv2-containerd-node-e2e-serial-1.25
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-25
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv2/image-config-cgroupv2-serial.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.25
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
  - always_run: false
    branches:
    - release-1.25
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-25
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv1-containerd-node-e2e-serial-1.25
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-25
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv1/image-config-cgroupv1.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags=" --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.25
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
  - always_run: false
    branches:
    - release-1.26
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-26
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv2-containerd-node-e2e-serial-1.26
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-26
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv2/image-config-cgroupv2-serial.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.26
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
  - always_run: false
    branches:
    - release-1.26
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-26
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv1-containerd-node-e2e-serial-1.26
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-26
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv1/image-config-cgroupv1.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.26
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
  - always_run: false
    branches:
    - release-1.27
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-27
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv2-containerd-node-e2e-serial-1.27
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv2-containerd-node-e2e-serial-1-27
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv2/image-config-cgroupv2-serial.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroup-driver=systemd --cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.27
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
  - always_run: false
    branches:
    - release-1.27
    cluster: k8s-infra-prow-build
    context: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-27
    labels:
      preset-k8s-ssh: "true"
      preset-service-account: "true"
      preset-pull-kubernetes-e2e: "true"
      preset-pull-kubernetes-e2e-gce: "true"
    annotations:
      testgrid-dashboards: sig-node-presubmits
      testgrid-tab-name: pr-node-kubelet-cgroupv1-containerd-node-e2e-serial-1.27
    max_concurrency: 12
    name: pull-kubernetes-cos-cgroupv1-containerd-node-e2e-serial-1-27
    spec:
      containers:
      - args:
        - --root=/go/src
        - --job=$(JOB_NAME)
        - --repo=k8s.io/$(REPO_NAME)=$(PULL_REFS)
        - --repo=github.com/containerd/containerd=main
        - --service-account=/etc/service-account/service-account.json
        - --upload=gs://kubernetes-jenkins/pr-logs
        - --timeout=260
        - --scenario=kubernetes_e2e
        - --
        - --node-args=--image-config-file=/workspace/test-infra/jobs/e2e_node/containerd/containerd-main/cgroupv1/image-config-cgroupv1.yaml
        - --deployment=node
        - --gcp-zone=us-west1-b
        - '--node-test-args=--container-runtime-endpoint=unix:///run/containerd/containerd.sock --container-runtime-process-name=/home/containerd/usr/local/bin/containerd --container-runtime-pid-file= --kubelet-flags="--cgroups-per-qos=true --cgroup-root=/ --runtime-cgroups=/system.slice/containerd.service" --extra-log="{\"name\": \"containerd.log\", \"journalctl\": [\"-u\", \"containerd*\"]}"'
        - --node-tests=true
        - --provider=gce
        - --test_args=--nodes=1 --timeout=4h --focus="\[Serial\]" --skip="\[Flaky\]|\[Benchmark\]|\[NodeSpecialFeature:.+\]|\[NodeSpecialFeature\]|\[NodeAlphaFeature:.+\]|\[NodeAlphaFeature\]|\[NodeFeature:Eviction\]"
        - --timeout=240m
        image: gcr.io/k8s-staging-test-infra/kubekins-e2e:v20230509-e4070b06c0-1.27
        name: ""
        resources:
          limits:
            cpu: "4"
            memory: 6Gi
          requests:
            cpu: "4"
            memory: 6Gi
