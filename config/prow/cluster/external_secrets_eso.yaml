apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: k8s-prow-builds
spec:
  provider:
    gcpsm:
      projectID: k8s-prow-builds
---
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: k8s-prow
spec:
  provider:
    gcpsm:
      projectID: k8s-prow
---
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: kubernetes-public
spec:
  provider:
    gcpsm:
      projectID: kubernetes-public
---
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: k8s-infra-prow-build-trusted
spec:
  provider:
    gcpsm:
      projectID: k8s-infra-prow-build-trusted
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: k8s-prow-build-service-account
  namespace: test-pods
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow-builds               # name of the SecretStore (or kind specified)
  target:
    name: service-account  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: default-k8s-build-cluster-service-account-key  # name of the GCPSM secret key
    remoteRef:
      key: service-account.json
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: prometheus-alert-slack-post-prow-alerts-secret-url
  namespace: prow-monitoring
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: prometheus-alert-slack-post-prow-alerts-secret-url  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: prometheus-alert-slack-post-prow-alerts-secret-url  # name of the GCPSM secret key
    remoteRef:
      key: url
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: prometheus-alert-slack-post-testing-ops-secret-url
  namespace: prow-monitoring
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: prometheus-alert-slack-post-testing-ops-secret-url  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: prometheus-alert-slack-post-testing-ops-secret-url  # name of the GCPSM secret key
    remoteRef:
      key: url
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: grafana
  namespace: prow-monitoring
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: grafana  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: gke_k8s-prow_us-central1-f_prow__prow-monitoring__grafana  # name of the GCPSM secret key
    remoteRef:
      key: password
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: k8s-infra-cherrypick-robot-github-token
  namespace: default
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: kubernetes-public               # name of the SecretStore (or kind specified)
  target:
    name: k8s-infra-cherrypick-robot-github-token  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: k8s-infra-cherrypick-robot-github-token  # name of the GCPSM secret key
    remoteRef:
      key: token
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: kubeconfig-prow-services
  namespace: test-pods
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: kubeconfig-prow-services  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: gke_k8s-prow_us-central1-f_prow__default__prow-services  # name of the GCPSM secret key
    remoteRef:
      key: config
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: kubeconfig-build-test-infra-trusted
  namespace: default
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: kubeconfig-build-test-infra-trusted  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: prow_build_cluster_kubeconfig_test-infra-trusted  # name of the GCPSM secret key
    remoteRef:
      key: kubeconfig
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: kubeconfig-build-k8s-prow-builds
  namespace: default
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: kubeconfig-build-k8s-prow-builds  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: gke_k8s-prow-builds_us-central1-f_prow__default__build-k8s-prow-builds  # name of the GCPSM secret key
    remoteRef:
      key: kubeconfig
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: kubeconfig-build-rules-k8s
  namespace: default
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-prow               # name of the SecretStore (or kind specified)
  target:
    name: kubeconfig-build-rules-k8s  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: gke_rules-k8s_us-central1-f_testing__default__build-rules-k8s  # name of the GCPSM secret key
    remoteRef:
      key: kubeconfig
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: cluster-api-provider-digitalocean-quayio
  namespace: default
spec:
  refreshInterval: 10s           # rate SecretManager pulls GCPSM
  secretStoreRef:
    kind: SecretStore
    name: k8s-infra-prow-build-trusted               # name of the SecretStore (or kind specified)
  target:
    name: cluster-api-provider-digitalocean-quayio  # name of the k8s Secret to be created
    creationPolicy: Owner
  data:
  - secretKey: capdo-quayio-registry-secret  # name of the GCPSM secret key
    remoteRef:
      key: config.json
